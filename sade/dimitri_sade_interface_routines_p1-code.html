<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Thu Jul  4 16:01:54 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dimitri_sade_interface_routines_p1.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dimitri_sade_interface_routines_p1.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO DIMITRI_SADE_INTERFACE_ROUTINES_P1

<span class="comments">;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="comments">;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="comments">;</span>
<span class="comments">; SECTION 1: SENSOR INTERCOMPARION/INTERCALIBRATION/RECALIBRATION</span>
<span class="comments">;</span>
<span class="comments">;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="comments">;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>

<span class="comments">;----------------------------</span>
<span class="comments">; USAGE</span>
<span class="comments">;</span>
<span class="comments">; UPDATE THE PARAMETERS BELOW FOR YOUR INTERESTED DIMITRI SCENARIOS, THEN RUN THE PROGRAM (NEED TO RESTORE DIMITRI_V2.SAV)</span>
<span class="comments">; ALL NOMINAL DIMITRI OUTPUTS WILL BE PLACED IN THE DEFINED "OFOLDER"</span>
<span class="comments">; A LOOP WILL INTERCOMPARE AND RECALIBRATE ANY NUMBER OF DEFINED CALIBRATION SENSORS TO THE DEFINE REFERENCE SENSOR</span>

<span class="comments">;----------------------------</span>
<span class="comments">; SET UP PARAMETERS</span>

  MAIN_DIR          = GET_DIMITRI_LOCATION('DIMITRI')<span class="comments">;FULL PATH OF THE MAIN DIMITRI DIRECTORY</span>
  OFOLDER           = FILEPATH('',root_dir = MAIN_DIR, subdir=['Output','VGT_TEST_2']) <span class="comments">; FULL PATH OF THE OUTPUT FOLDER TO BE CREATED</span>
  <span class="comments">;REGION            = 'Niger2'                            ; VALIDATION SITE NAME</span>
  REGION            = 'DomeC'                            <span class="comments">; VALIDATION SITE NAME</span>
  <span class="comments">;REGION            = 'Libya4'                            ; VALIDATION SITE NAME</span>
  SENSOR1           = 'MERIS'                             <span class="comments">; REFERENCE SENSOR</span>
  PROC_VER1         = '2nd_Reprocessing'                  <span class="comments">; REFERENCE SENSOR PROCESSING VERSION</span>
  SENSOR2S          = ['MODISA','PARASOL']                  <span class="comments">; CALIBRATION SENSORs - insert as many as you wish</span>
  PROC_VER2S        = ['Collection_5','Calibration_1'] <span class="comments">; CALIBRATION SENSOR PROCESSING VERSIONS</span>
  AMC_THRESHOLD     = 10                                  <span class="comments">; AMC THRESHOLD VALUE</span>
  DAY_OFFSET        = 2                                   <span class="comments">; DAY OFFSET IN INTEGER DAYS</span>
  VZA_MIN           = 0.                                  <span class="comments">; VZA MIN ANGLE (DEGREES)</span>
  VZA_MAX           = 90.                                 <span class="comments">; VZA MAX ANGLE (DEGREES)</span>
  VAA_MIN           = 0.                                  <span class="comments">; VAA MIN ANGLE (DEGREES)</span>
  VAA_MAX           = 360.                                <span class="comments">; VAA MAX ANGLE (DEGREES)</span>
  SZA_MIN           = 0.                                  <span class="comments">; SZA MIN ANGLE (DEGREES)</span>
  SZA_MAX           = 90.                                 <span class="comments">; SZA MAX ANGLE (DEGREES)</span>
  SAA_MIN           = 0.                                  <span class="comments">; SAA MIN ANGLE (DEGREES)</span>
  SAA_MAX           = 360.                                <span class="comments">; SAA MAX ANGLE (DEGREES)</span>
  <span class="comments">;SADE_DIR          = '/mnt/Projects/MEREMSII/WG_Reference_Dataset_2/distributable_files/' ;CHANGE THIS TO THE LOCATION OF YOUR SADE FILES (NOTE, REGION SUBDIRECTORY IN FILEPATH BELOW</span>
  CASE STRUPCASE(!VERSION.OS_FAMILY) OF 
  'WINDOWS': SADE_DIR = 'R:\MEREMSII\WG_Reference_Dataset\distributable_files\'
  'UNIX':    SADE_DIR = '/mnt/Projects/MEREMSII/WG_Reference_Dataset/distributable_files/'
  ENDCASE

  FOR IVOS=0,N_ELEMENTS(SENSOR2S)-1 DO BEGIN
    SENSOR2   = SENSOR2S[IVOS]
    PROC_VER2 = PROC_VER2S[IVOS]
    SADE1           = FILEPATH(REGION+'_'+SENSOR1+'_'+PROC_VER1+'.SADE',ROOT_DIR=SADE_DIR,SUBDIR=[REGION])<span class="comments">; FULL PATH TO THE SADE FILE FOR THE REFERENCE SENSOR</span>
    SADE2           = FILEPATH(REGION+'_'+SENSOR2+'_'+PROC_VER2+'.SADE',ROOT_DIR=SADE_DIR,SUBDIR=[REGION])<span class="comments">; FULL PATH TO THE SADE FILE FOR THE CALIBRATION SENSOR</span>


<span class="comments">;----------------------------</span>
<span class="comments">; DOUBLET EXTRACTION</span>

    RES = EXTRACT_DOUBLETS(OFOLDER,REGION,SENSOR1,PROC_VER1,SENSOR2,PROC_VER2,AMC_THRESHOLD,   $
                              DAY_OFFSET,99.0,1.0,                                             $ <span class="comments">; NO NEED TO CHANGE THESE, THEY ARE USED TO SEARCH THROUGH ALL DATA</span>
                              VZA_MIN,VZA_MAX,VAA_MIN,VAA_MAX,SZA_MIN,SZA_MAX,SAA_MIN,SAA_MAX, $
                              SADE1=SADE1,SADE2=SADE2)
  
    IF RES[0] NE 1 THEN BEGIN
      PRINT, '******* ERROR, A PROBLEM OCCURED DURING DOUBLET EXTRACTION ********'
      stop
    ENDIF

<span class="comments">;----------------------------</span>
<span class="comments">; INTERCOMPARISON</span>

    RES = DIMITRI_INTERFACE_INTERCALIBRATION(OFOLDER,REGION,[SENSOR1],[PROC_VER1],[SENSOR2],[PROC_VER2],INDGEN(30))
    
    IF RES[0] NE 1 THEN BEGIN
      PRINT, '******* ERROR, A PROBLEM OCCURED DURING INTERCALIBRATION ********'
      stop
    ENDIF

<span class="comments">;----------------------------</span>
<span class="comments">; RECALIBRATION</span>

    RES = RECALIBRATE_DOUBLETS(OFOLDER,REGION,SENSOR1,PROC_VER1,SENSOR2,PROC_VER2,$
                               0.99,.01,$
                               VZA_MIN,VZA_MAX,VAA_MIN,VAA_MAX,SZA_MIN,SZA_MAX,SAA_MIN,SAA_MAX,$
                               SADE1=SADE1,SADE2=SADE2)
  
    IF RES[0] NE 1 THEN BEGIN
      PRINT, '******* ERROR, A PROBLEM OCCURED DURING RECALIBRATION ********'
      stop
    ENDIF

  ENDFOR <span class="comments">;LOOP ON CALIBRATION SENSORS</span>

<span class="comments">;----------------------------</span>
<span class="comments">; CONTANENATE</span>

  RES = CONCATENATE_TOA_REFLECTANCE(OFOLDER,REGION,SENSOR1,PROC_VER1)
  IF RES[0] NE 1 THEN BEGIN
    PRINT, '******* ERROR, A PROBLEM OCCURED DURING CONCATENATION ********'
    STOP
  ENDIF

  PRINT,'******* SUCCESS: COMPLETED SADE/DIMITRI PROCESSING ********'

END
</code>
    </div>
  </body>
</html>