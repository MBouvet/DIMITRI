<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Thu Jul  4 16:01:40 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dimitri_visualisation_super_rho.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dimitri_visualisation_super_rho.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      DIMITRI_VISUALISATION_SUPER_RHO     </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      THIS PROGRAM AUTOMATICALLY SERACHES AND RETRIEVES THE CONCATENATED SUPER SENSOR RHO VALUES </span>
<span class="comments">;*      OUTPUT BY DIMITRI GIVEN AN OUTPUT FOLDER AND REFERENCE SENSOR BAND.</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RES = DIMITRI_VISUALISATION_SUPER_RHO(RC_FOLDER,RC_REGION,REF_SENSOR,REF_PROC_VER,DIMITRI_BAND)      </span>
<span class="comments">;*</span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      rc_FOLDER     - A STRING OF THE FULL PATH FOR THE RECALIBRATION OUTPUT FOLDER</span>
<span class="comments">;*      RC_REGION     - A STRING OF THE DIMITRI VALIDATION SITE REQUESTED</span>
<span class="comments">;*      REF_SENSOR    - A STRING OF THE REFERENCE SENSOR </span>
<span class="comments">;*      REF_PROC_VER  - A STRING OF THE REFERENCE SENSORS PROCESSING VERSION</span>
<span class="comments">;*      DIMITRI_BAND  - AN INTEGER OF THE DIMITRI BAND INDEX</span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      A STRUCTURE WITH THE FOLLOWING TAGS:</span>
<span class="comments">;*      ERROR             - THE ERROR STATUS CODE, 0 = NOMINAL, 1 OR -1 = ERROR</span>
<span class="comments">;*      SS_DATA           - AN ARRAY CONTAINING THE SUPER SENSOR REFLECTANCE AND TIME</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*      19 MAY 2011 - C KENT    - DIMITRI-2 V1.0</span>
<span class="comments">;*      04 JUL 2011 - C KENT    - UPDATED NUM OF NON REFLECTANCE VARIABLE</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

FUNCTION DIMITRI_VISUALISATION_SUPER_RHO,RC_FOLDER,RC_REGION,REF_SENSOR,REF_PROC_VER,DIMITRI_BAND,VERBOSE=VERBOSE

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_VISU_SUPER: STARTING RETRIEVAL OF DATA'
  RAISE_NO_SDATA = 1
  NUM_NON_REF = 5+12 <span class="comments">;(TIME, ANGLES (4) AND AUX INFO (12)</span>

<span class="comments">;-----------------------------------------</span>
<span class="comments">; RETRIEVE THE SITE TYPE</span>

  SITE_TYPE = GET_SITE_TYPE(RC_REGION,VERBOSE=VERBOSE)

<span class="comments">;-----------------------------------------</span>
<span class="comments">; ADD MODIS LAND/OCEAN EXCEPTION</span>
      
  IF REF_SENSOR EQ 'MODISA' THEN BEGIN
    IF STRUPCASE(SITE_TYPE) EQ 'OCEAN' THEN TEMP_SENSOR1 = REF_SENSOR+'_O' ELSE TEMP_SENSOR1 = REF_SENSOR+'_L'
  ENDIF ELSE TEMP_SENSOR1 = REF_SENSOR

<span class="comments">;-------------------------------- </span>
<span class="comments">; FIND SUPER SENSOR DAT FILE AND RESTORE IF AVAILABLE</span>
  
  RES = GET_SENSOR_BAND_INDEX(TEMP_SENSOR1,DIMITRI_BAND)
  IF RES[0] LT 0 THEN GOTO, SSEN_NO_DATA $
  ELSE BEGIN
    TMP_BAND  = CONVERT_INDEX_TO_WAVELENGTH(RES[0],TEMP_SENSOR1)
    PRD_STR   = STRING(RC_FOLDER +'SSEN_'      +RC_REGION+'_REF_'+REF_SENSOR+'_'+REF_PROC_VER+'_'+TMP_BAND+'.DAT')
 
    IF FILE_TEST(PRD_STR) EQ 0 THEN GOTO, SSEN_NO_DATA
    RAISE_NO_SDATA = 0
    RESTORE,PRD_STR
   
    SSEN_DATA = SS_DATA
    N = N_ELEMENTS(SSEN_DATA[0,*])
  
    SS_DATA = MAKE_ARRAY(N,2,/FLOAT)
    SS_DATA[*,0] = SSEN_DATA[0,*]
    SS_DATA[*,1] = SSEN_DATA[NUM_NON_REF,*]  
  ENDELSE
 
  SSEN_NO_DATA:
  IF RAISE_NO_SDATA THEN BEGIN
    PRINT, 'DIMITRI_VISU_SUPER: NO DATA FOUND, RETURNING'
    RETURN,{ERROR:1,SS_DATA:MAKE_ARRAY(5,2,/FLOAT)}
  ENDIF 

<span class="comments">;-------------------------------- </span>
<span class="comments">; RETURN THE SUPERSENSOR RHO ARRAY</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_VISU_SUPER: RETURNING DATA STRUCTURE' 
  VISU_SSEN = {                                             $
              ERROR:0                                      ,$
              SS_DATA:SS_DATA                               $
              }

  RETURN,VISU_SSEN

END
</code>
    </div>
  </body>
</html>