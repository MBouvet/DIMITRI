<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Tue Jul  2 12:50:52 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dimitri_v2.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dimitri_v2.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      DIMITRI_V2 </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      THESE ROUTINES GENERATE THE MAIN DIMITRI HMI WIDGET WHICH ALLOWS INTERFACE </span>
<span class="comments">;*      TO A NUMBER OF THE DIMITRI FUNCTIONS</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      DIMITRI_V2     </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      NONE     </span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE  - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      DHMI_DATABASE - CONTAINS THE DATABASE DATA FOR THE DIMITRI HMI</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*        31 MAR 2011 - C KENT    - DIMITRI-2 V1.0</span>
<span class="comments">;*        17 MAY 2011 - C KENT    - ADDED PROCESS 2</span>
<span class="comments">;*        20 JUN 2011 - C KENT    - ADDED LINUX ACROBAT READER FOR SUM</span>
<span class="comments">;*        06 JUL 2011 - C KENT    - ADDED DATABASE COMMON BLOCK TO DIMITRI HMI</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*        14 APR 2011 - C KENT    - WINDOWS 32-BIT IDL 7.1 AND LINUX 64-BIT IDL 8.0 NOMINAL</span>
<span class="comments">;*                                  COMPILATION AND OPERATION        </span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

PRO DHMI_OBJECT_EVENT,EVENT

<span class="comments">;---------------------------</span>
<span class="comments">; CATCH WIDGET RESIZE AND DO NOTHING</span>

  WIDGET_CONTROL, EVENT.TOP,  GET_UVALUE=DHMI_INFO, /NO_COPY
  WIDGET_CONTROL, EVENT.TOP,  SET_UVALUE=DHMI_INFO, /NO_COPY

END

<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

PRO DHMI_BUTTON_EVENT,EVENT

<span class="comments">;---------------------------</span>
<span class="comments">; RETRIEVE WIDGET INFORMATION</span>

  WIDGET_CONTROL, EVENT.TOP,  GET_UVALUE=DHMI_INFO, /NO_COPY
  WIDGET_CONTROL, EVENT.ID,   GET_UVALUE=ACTION

<span class="comments">;---------------------------</span>
<span class="comments">; CALL FUNCTIONALITY DPEENDING ON ACTION REQUEST</span>

  IF DHMI_INFO.IVERBOSE EQ 1 THEN PRINT,'DIMITRI_HMI->EVENT: STARTING FUNCTION FOR ACTION - ',ACTION 
  CASE ACTION OF
    'INGEST'          : DHMI_INGEST,              GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'NEW_SITE'        : DIMITRI_NEW_SITE_WD,      GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'DOWNLOAD'        : DIMITRI_DOWNLOAD_WD,      GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'CLOUD_SCREENING' : DHMI_CS_SETUP,            GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'PROCESS 1'       : DHMI_PROCESS_1,           GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'PROCESS 2'       : DHMI_PROCESS_2,           GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'VISU'            : DHMI_VISU,                GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'DATABASE_STATS'  : DIMITRI_DATABASE_STATS_WD,GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'RSR'             : DHMI_RSR,                 GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'OPTIONS'         : DHMI_CONFIGURATION,       GROUP_LEADER=EVENT.TOP,VERBOSE=DHMI_INFO.IVERBOSE
    'HELP'            : BEGIN
                          CASE STRUPCASE(!VERSION.OS_FAMILY) OF 
                            'WINDOWS':  SPAWN,DHMI_INFO.SUM,/HIDE,/NOWAIT
                            'UNIX':     SPAWN,STRING('acroread '+DHMI_INFO.SUM)
                          ENDCASE  
                        END
    'ABOUT'           : BEGIN
                          MSG   = [	'DIMITRI Version 2.0','Release Date: 03/07/2012'              ,$
                                    'IDL 7.0 Or Higher required','___________________',''             ,$
                                    'Email: ','=> Dimitri@argans.co.uk'                  ,$
                                    'Authors:','=> Marc Bouvet (ESA-ESTEC)','=> Chris Kent (ARGANS Ltd)']
	                        ABOUT = DIALOG_MESSAGE(MSG,/INFORMATION,TITLE = 'DIMITRI V2.0: ABOUT',/CENTER)
                        END
  ENDCASE

  WIDGET_CONTROL, EVENT.TOP,  SET_UVALUE=DHMI_INFO, /NO_COPY

END

<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

PRO DHMI_EXIT_EVENT,EVENT

<span class="comments">;---------------------------</span>
<span class="comments">; DESTROY THE WIDGET</span>

  WIDGET_CONTROL, EVENT.TOP,  GET_UVALUE=DHMI_INFO, /NO_COPY
  IF DHMI_INFO.IVERBOSE EQ 1 THEN PRINT,'DIMITRI_HMI->EXIT: DESTROYING THE WIDGET'
  WIDGET_CONTROL,EVENT.TOP,/DESTROY

END

<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

PRO DIMITRI_V2,VERBOSE=VERBOSE

COMMON DHMI_DATABASE,DHMI_DB_DATA

  IF KEYWORD_SET(VERBOSE) THEN BEGIN
  IVERBOSE = 1 
  PRINT, 'DIMITRI_HMI: STARTING HMI GENERATION SCRIPT'
  ENDIF ELSE IVERBOSE=0
  SUM  = GET_DIMITRI_LOCATION('SUM')

<span class="comments">;---------------------------</span>
<span class="comments">; SET THE WINDOW PROPERTIES</span>

  MACHINE_WINDOW = !D.NAME
  CASE STRUPCASE(!VERSION.OS_FAMILY) OF 
    'WINDOWS':  SET_PLOT,'WIN'
    'UNIX':     SET_PLOT,'X'
  ENDCASE

<span class="comments">;---------------------------</span>
<span class="comments">; LOAD PNG IMAGES</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: LOADING PNG IMAGES'
  TITLE     = GET_DIMITRI_LOCATION('TITLE_PNG')      
  INGEST    = GET_DIMITRI_LOCATION('INGEST_PNG')      
  PROCESS   = GET_DIMITRI_LOCATION('PROCESS_PNG')      
  VISUALISE = GET_DIMITRI_LOCATION('VISU_PNG')      

  READ_PNG,TITLE,TITLE_IMAGE
  READ_PNG,INGEST,INGEST_IMAGE
  READ_PNG,PROCESS,PROCESS_IMAGE
  READ_PNG,VISUALISE,VISUALISE_IMAGE
  DIMS = SIZE(TITLE_IMAGE)

<span class="comments">;--------------------------</span>
<span class="comments">; LOAD THE DATABASE INTO A COMMON BLOCK</span>

  DB_FILE = GET_DIMITRI_LOCATION('DATABASE')
  DB_TEMPLATE = GET_DIMITRI_TEMPLATE(1,/TEMPLATE)
  DHMI_DB_DATA = READ_ASCII(DB_FILE,TEMPLATE=DB_TEMPLATE)

<span class="comments">;---------------------------</span>
<span class="comments">; DEFINE WIDGET PARAMETERS</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: DEFINING WIDGET PARAMETERS'  
  MAIN_BTN_SIZE = 120
  SMLL_BTN_SIZE = 80

  SCR_DIMS = GET_SCREEN_SIZE()
  XSIZE = DIMS[2]+10
  YSIZE = 220
  XLOC  = (SCR_DIMS[0]/2)-(XSIZE/2)
  YLOC  = (YSIZE/2)
  
  BTEVENT = 'DHMI_BUTTON_EVENT'
  EXEVENT = 'DHMI_EXIT_EVENT'

<span class="comments">;---------------------------</span>
<span class="comments">; DEFINE MAIN WIDGET BASE</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: DEFINING MAIN HMI WIDGET'
  DTLB = WIDGET_BASE(XSIZE=XSIZE,YSIZE=YSIZE,XOFFSET=XLOC,YOFFSET=YLOC,TITLE='DIMITRI V2.0',COLUMN=1)

<span class="comments">;---------------------------</span>
<span class="comments">; ADD DRAW_WIDGET FOR MAIN TITLE IMAGE</span>

  DTLB_IMG = WIDGET_DRAW(DTLB,XSIZE=DIMS[2],YSIZE=DIMS[3]-3,SENSITIVE=0,RETAIN=2)
  DTLB_TOP = WIDGET_BASE(DTLB,COLUMN=7,/ALIGN_CENTER)

<span class="comments">;---------------------------</span>
<span class="comments">; ADD INGEST IMAGE AND BUTTONS</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: ADDING INGESTION OPTION BOX'
  DTLB_TOP_INGEST       = WIDGET_BASE(DTLB_TOP,COLUMN=1,FRAME=1)
  DTLB_TOP_INGEST_IMG_B = WIDGET_BASE(DTLB_TOP_INGEST)
  DTLB_TOP_INGEST_IMG   = WIDGET_DRAW(DTLB_TOP_INGEST_IMG_B,XSIZE=146,YSIZE=23,SENSITIVE=0,RETAIN=2)
  DTLB_TOP_INGEST_C     = WIDGET_BASE(DTLB_TOP_INGEST,COLUMN=1,/ALIGN_CENTER)
  DTLB_TOP_INGEST_BTN   = WIDGET_BUTTON(DTLB_TOP_INGEST_C,VALUE='Add L1b Data',UVALUE='INGEST',XSIZE=MAIN_BTN_SIZE,EVENT_PRO=BTEVENT)
  DTLB_TOP_INGEST_BTN   = WIDGET_BUTTON(DTLB_TOP_INGEST_C,VALUE='New Site',XSIZE=MAIN_BTN_SIZE,UVALUE='NEW_SITE',EVENT_PRO=BTEVENT)
  DTLB_TOP_INGEST_BTN   = WIDGET_BUTTON(DTLB_TOP_INGEST_C,VALUE='Data Download',XSIZE=MAIN_BTN_SIZE,UVALUE='DOWNLOAD',EVENT_PRO=BTEVENT)

  DTLB_TOP_BLK = WIDGET_BASE(DTLB_TOP,COLUMN=1)
  DTLB_TOP_BLK = WIDGET_BASE(DTLB_TOP,COLUMN=1)

<span class="comments">;---------------------------</span>
<span class="comments">; ADD PROCESS IMAGE AND BUTTONS</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: ADDING PROCESS OPTION BOX'
  DTLB_TOP_PROC         = WIDGET_BASE(DTLB_TOP,COLUMN=1,FRAME=1)
  DTLB_TOP_PROC_B       = WIDGET_BASE(DTLB_TOP_PROC)
  DTLB_TOP_PROCESS_IMG  = WIDGET_DRAW(DTLB_TOP_PROC_B,XSIZE=146,YSIZE=23,SENSITIVE=0,RETAIN=2)
  DTLB_TOP_PROC_C       = WIDGET_BASE(DTLB_TOP_PROC,COLUMN=1,/ALIGN_CENTER)
  DTLB_TOP_PROC_BTN     = WIDGET_BUTTON(DTLB_TOP_PROC_C,VALUE='Cloud Screening',UVALUE='CLOUD_SCREENING',XSIZE=MAIN_BTN_SIZE,EVENT_PRO=BTEVENT)
  DTLB_TOP_PROC_BTN     = WIDGET_BUTTON(DTLB_TOP_PROC_C,VALUE='Sensor Recal.',UVALUE='PROCESS 1',XSIZE=MAIN_BTN_SIZE,EVENT_PRO=BTEVENT)
  DTLB_TOP_PROC_BTN     = WIDGET_BUTTON(DTLB_TOP_PROC_C,VALUE='VGT Simulation',UVALUE='PROCESS 2',XSIZE=MAIN_BTN_SIZE,EVENT_PRO=BTEVENT)


  DTLB_TOP_BLK = WIDGET_BASE(DTLB_TOP,COLUMN=1)
  DTLB_TOP_BLK = WIDGET_BASE(DTLB_TOP,COLUMN=1)

<span class="comments">;---------------------------</span>
<span class="comments">; ADD VISU IMAGE AND BUTTONS</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: ADDING VISUALISTION OPTION BOX'
  DTLB_TOP_VISU           = WIDGET_BASE(DTLB_TOP,COLUMN=1,FRAME=1)
  DTLB_TOP_VISU_B         = WIDGET_BASE(DTLB_TOP_VISU)
  DTLB_TOP_VISUALISE_IMG  = WIDGET_DRAW(DTLB_TOP_VISU_B,XSIZE=146,YSIZE=23,SENSITIVE=0,RETAIN=2)
  DTLB_TOP_VISU_C         = WIDGET_BASE(DTLB_TOP_VISU,COLUMN=1,/ALIGN_CENTER)
  DTLB_TOP_VISU_BTN       = WIDGET_BUTTON(DTLB_TOP_VISU_C,VALUE='View Outputs',XSIZE=MAIN_BTN_SIZE,UVALUE='VISU',EVENT_PRO=BTEVENT)
  DTLB_TOP_VISU_BTN       = WIDGET_BUTTON(DTLB_TOP_VISU_C,VALUE='RSR Data',XSIZE=MAIN_BTN_SIZE,UVALUE='RSR',EVENT_PRO=BTEVENT)
  DTLB_TOP_VISU_BTN       = WIDGET_BUTTON(DTLB_TOP_VISU_C,VALUE='Database Stats',XSIZE=MAIN_BTN_SIZE,UVALUE='DATABASE_STATS',EVENT_PRO=BTEVENT)

<span class="comments">;---------------------------</span>
<span class="comments">; ADD OPTION BUTTONS</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: ADDING USER OPTION BOX'
  DTLB_BTM      = WIDGET_BASE(DTLB,ROW=1,FRAME=1,/ALIGN_CENTER)
  DTLB_BTM_BTN  = WIDGET_BUTTON(DTLB_BTM,VALUE='Options',XSIZE=SMLL_BTN_SIZE,UVALUE='OPTIONS',EVENT_PRO=BTEVENT)
  DTLB_BTM_BTN  = WIDGET_BUTTON(DTLB_BTM,VALUE='Help',XSIZE=SMLL_BTN_SIZE,UVALUE='HELP',EVENT_PRO=BTEVENT)
  DTLB_BTM_BTN  = WIDGET_BUTTON(DTLB_BTM,VALUE='About',XSIZE=SMLL_BTN_SIZE,UVALUE='ABOUT',EVENT_PRO=BTEVENT)
  DTLB_BTM_BTN  = WIDGET_BUTTON(DTLB_BTM,VALUE='Exit',XSIZE=SMLL_BTN_SIZE,EVENT_PRO=EXEVENT)

<span class="comments">;---------------------------</span>
<span class="comments">; REALISE THE WIDGET AND DISPLAY THE PNG IMAGES</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: REALISING THE WIDGET AND DISPLAYING PNG IMAGES'
  WIDGET_CONTROL, DTLB, /REALIZE
  WIDGET_CONTROL, DTLB_IMG, GET_VALUE=D1
  WSET, D1
  TV, TITLE_IMAGE, TRUE=1
   
  WIDGET_CONTROL, DTLB_TOP_INGEST_IMG, GET_VALUE=D2
  WSET, D2
  TV, INGEST_IMAGE, TRUE=1

  WIDGET_CONTROL, DTLB_TOP_PROCESS_IMG, GET_VALUE=D3
  WSET, D3
  TV, PROCESS_IMAGE, TRUE=1
  
  WIDGET_CONTROL, DTLB_TOP_VISUALISE_IMG, GET_VALUE=D4
  WSET, D4
  TV, VISUALISE_IMAGE, TRUE=1  
  
<span class="comments">;---------------------------</span>
<span class="comments">; STORE WIDGET INFO IN STRUCTURE</span>
  
  DHMI_INFO = {$
                IVERBOSE:IVERBOSE ,$  
                SUM:SUM           ,$
                GROUP_LEADER: DTLB $
              }

<span class="comments">;---------------------------</span>
<span class="comments">; REGISTER WITH THE XMANAGER</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'DIMITRI_HMI: REGISTERING WITH THE XMANAGER'  
  WIDGET_CONTROL, DTLB, SET_UVALUE=DHMI_INFO,/NO_COPY
  XMANAGER,'DHMI_OBJECT', DTLB

END
</code>
    </div>
  </body>
</html>