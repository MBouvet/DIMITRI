<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Thu Jul  4 16:01:41 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>rsr_legend_update.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="rsr_legend_update.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      RSR_LEGEND_UPDATE       </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      THIS FUNCTION IS CALLED BY THE ROUTINE "PLOT_DIMITRI_SENSOR_RSR" AND UPDATE THE </span>
<span class="comments">;*      LEGEND INFORMATION BASED ON AN ARRAY DETAILING WHICH VALUES ARE CURRENTLY PLOTTED. </span>
<span class="comments">;*</span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RSR_INFO = RSR_LEGEND_UPDATE(RSR_INFO)     </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      RSR_INFO  - THE RSR_INFO STRUCTURE AS DEFINED WITHIN "PLOT_DIMITRI_SENSOR_RSR"</span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE   - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*      30 MAR 2011 - C KENT   - DIMITRI-2 V1.0</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*      14 APR 2011 - C KENT   - WINDOWS 32-BIT IDL 7.1 AND LINUX 64-BIT IDL 8.0 NOMINAL</span>
<span class="comments">;*                               COMPILATION AND OPERATION </span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

FUNCTION RSR_LEGEND_UPDATE,RSR_INFO,VERBOSE=VERBOSE

<span class="comments">;--------------------------</span>
<span class="comments">; DEFINE INITIAL COLOUR ARRAY </span>
<span class="comments">; AND FIND WHICH DATA IS ON</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'RSR_LEGEND_UPDATE: STARING UPDATE OF PLOT LEGEND'
  RES = WHERE(RSR_INFO.DATA_ON EQ 1)
  IF RES[0] EQ -1 THEN GOTO, NO_LEGEND_UPDATE
  TEMP_COLOURS = BYTARR(3,N_ELEMENTS(RES))

<span class="comments">;--------------------------</span>
<span class="comments">; STARTING LOOP OVER EACH DATA_ON</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'RSR_LEGEND_UPDATE: STARING LOOP OVER EACH DATA ON VALUE'
  FOR I=0,N_ELEMENTS(RES)-1 DO BEGIN

    TEMP = RSR_INFO.DATA_ON_LIST[RES[I]]
    ACT = STRMID(TEMP,0,3)

    IF ACT EQ RSR_INFO.TEXT_RSR OR ACT EQ RSR_INFO.TEXT_SEN THEN BEGIN

      TEMP = STRSPLIT(TEMP,'_',/EXTRACT)
      SENS = TEMP[N_ELEMENTS(TEMP)-1]
      SENS_ID = WHERE(RSR_INFO.SENSOR_ID EQ SENS)
      TEMP_COLOURS[*,I] = RSR_INFO.SENSOR_COLOURS[*,SENS_ID]
    
    ENDIF ELSE BEGIN
      
      TEMP_SITE = STRMID(TEMP,4,STRLEN(TEMP)-4)
      SITE_ID = WHERE(RSR_INFO.SPECTRA_NAMES EQ TEMP_SITE)
      TEMP_COLOURS[*,I] = RSR_INFO.SITE_COLOURS[*,SITE_ID]
    
    ENDELSE
  ENDFOR

<span class="comments">;--------------------------</span>
<span class="comments">; UPDATING THE LEGEND OBJECT</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'RSR_LEGEND_UPDATE: UPDATING LEGEND OBJECT'
  RSR_INFO.RSR_LEGEND->SETPROPERTY, ITEM_NAME  = RSR_INFO.LEGEND_NAMES[RES]           ,$
                                    ITEM_COLOR = TEMP_COLOURS                         ,$
                                    THICK      = MAKE_ARRAY(N_ELEMENTS(RES),VALUE=2)

  NO_LEGEND_UPDATE:
  IF KEYWORD_SET(VERBOSE) THEN PRINT,'RSR_LEGEND_UPDATE: RETURNING NEW RSR_INFO'
  RETURN,RSR_INFO

END
</code>
    </div>
  </body>
</html>