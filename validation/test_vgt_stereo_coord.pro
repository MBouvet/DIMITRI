pro test_vgt_stereo_coord
;send to the function - num x and y pixels, center lon and lat, corner coordinates


  IMAGE = FLTARR(718,718)
  S = SIZE(IMAGE,/DIMENSIONS)

  MAPSTRUCT = MAP_PROJ_INIT("POLAR STEREOGRAPHIC", $
       CENTER_LONGITUDE=0., CENTER_LATITUDE=-90.)

  LONGITUDE = [119.176430D, 108.287659, 126.491297, 141.334801]
  LATITUDE =  [-79.332321D, -73.491156, -70.553161, -75.130937]
   
  UV = MAP_PROJ_FORWARD(LONGITUDE, LATITUDE, MAP_STRUCTURE=MAPSTRUCT)
  TIDX = [0,1,3,2]
  SIDX = [0,1,2,3]
  
  U = MAKE_ARRAY(2,2,/DOUBLE)
  V = MAKE_ARRAY(2,2,/DOUBLE)
  U[SIDX] = UV[0,TIDX]
  V[SIDX] = UV[1,TIDX]
    
STOP
  IX = FINDGEN(718)/717.0
  IY = FINDGEN(718)/717.0

  UNEW = BILINEAR(U, IX, IY)
  VNEW = BILINEAR(V, IX, IY)
  RES = MAP_PROJ_INVERSE(UNEW, VNEW, MAP_STRUCTURE=MAPSTRUCT)
  NU = REFORM(RES[0,*],S[0],S[1])
  NV = REFORM(RES[1,*],S[0],S[1])

STOP
END