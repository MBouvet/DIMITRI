<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Thu Jul  4 16:01:27 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>aatsr_correct_v16_nonlinearity.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="aatsr_correct_v16_nonlinearity.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">;FILE: AATSR_CORRECT_V16_NONLINEARITY.PRO</span>
<span class="comments">;FUNCTION:</span>
<span class="comments">;       If GC1 filename = ATS_GC1_AXVIEC20020123_073430_20020101_000000_20200101_000000 then</span>
<span class="comments">;       no nonlinearity correction is NOT applied to 1.6um channel. The function then applies the correction</span>
<span class="comments">;       to the uncorrected data.  This method is described in detail in PO-TN-RAL-AT-0539 Issue 1.1</span>
<span class="comments">;</span>
<span class="comments">;ORIGINAL: Dave Smith RAL SSTD,  17-Jan-2008</span>
<span class="comments">;</span>
<span class="comments">;MODIFICATION: Dave Smith RAL SSTD, 30-Jul-2008 </span>
<span class="comments">;              Correction to account for scaling of 1.6um reflectance values which should be 0-1. Previous version worked on range 0-100%.</span>
<span class="comments">;</span>
<span class="comments">;IMPORT:</span>
<span class="comments">;       GC1_FILENAME - String containing name of GC1 filename associated with L1B product - DSD31 in product</span>
<span class="comments">;       V16_UNCORRECTED - Variable containing 1.6um reflectance values from L1B product. The value(s) must be a</span>
<span class="comments">;                         in the range 0-1</span>
<span class="comments">;</span>
<span class="comments">;EXPORT:</span>
<span class="comments">;       V16_CORRECTED - Corrected 1.6um Refelectance. If no correction is needed then the input value is returned</span>
<span class="comments">;</span>
<span class="comments">;*************************************************************************************</span>
FUNCTION AATSR_CORRECT_V16_NONLINEARITY,GC1_FILENAME,V16_UNCORRECTED

<span class="comments">;Nonlinearity coefficients from pre-launch calibration</span>
    A = [-0.000027,-0.1093,0.009393,0.001013]

<span class="comments">;Find out which nonlinearity correction has been applied - uses name of GC1 file</span>

<span class="comments">;Nonlinearity Correction NOT applied</span>
   IF(GC1_FILENAME EQ 'ATS_GC1_AXVIEC20020123_073430_20020101_000000_20200101_000000')THEN BEGIN

<span class="comments">;Convert 1.6um reflectance back to raw signal using linear conversion</span>
      VOLTS = V16_UNCORRECTED/0.192*(-0.816)

<span class="comments">;Convert 1.6um raw signal to reflectance using non-linear conversion function</span>
      V16_CORRECTED = !PI*(A(0)+A(1)*VOLTS+A(2)*VOLTS^2+A(3)*VOLTS^3)/1.553


<span class="comments">;Nonilinearity Correction Already Applied</span>
   ENDIF ELSE BEGIN
        V16_CORRECTED = V16_UNCORRECTED
   ENDELSE

RETURN,V16_CORRECTED
END
</code>
    </div>
  </body>
</html>