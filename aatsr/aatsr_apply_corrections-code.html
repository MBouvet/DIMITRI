<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Thu Jul  4 16:01:27 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>aatsr_apply_corrections.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="aatsr_apply_corrections.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;+</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      AATSR_APPLY_CORRECTIONS       </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      APPLIES DRIFT CORRECTION FOR AATSR BANDS</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RES = AATSR_APPLY_CORRECTIONS(AATSR_IMAGE,DRIFT_TABLE=DRIFT_TABLE)      </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      AATSR_IMAGE - AN IMAGE STRUCTURE RETURNED FROM ENVISAT.PRO/AATSR.PRO      </span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      DRIFT_TABLE - THE LOCATION FOR THE DRIFT COEFICIENTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      AATSR_IMAGE - CORERECT FOR CALIBRATION DRIFT</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      None</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*                  - RAL/CCLRC - Initial version</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;* </span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

FUNCTION AATSR_APPLY_CORRECTIONS,AATSR_IMAGE,DRIFT_TABLE=DRIFT_TABLE
    V56 = 0
    V67 = 1
    V87 = 2
    V16 = 3

  NEW_AATSR_IMAGE = AATSR_IMAGE

<span class="comments">;Correct for nonlinearity</span>
  NEW_AATSR_IMAGE.NADIR_V16 = AATSR_CORRECT_V16_NONLINEARITY(AATSR_IMAGE.GC1_FILE,NEW_AATSR_IMAGE.NADIR_V16)
  NEW_AATSR_IMAGE.FRWRD_V16 = AATSR_CORRECT_V16_NONLINEARITY(AATSR_IMAGE.GC1_FILE,NEW_AATSR_IMAGE.FRWRD_V16)
  
<span class="comments">;Remove existing long term drift</span>
  NEW_AATSR_IMAGE.NADIR_V16 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V16,NEW_AATSR_IMAGE.NADIR_V16)
  NEW_AATSR_IMAGE.NADIR_V87 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V87,NEW_AATSR_IMAGE.NADIR_V87)
  NEW_AATSR_IMAGE.NADIR_V67 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V67,NEW_AATSR_IMAGE.NADIR_V67)
  NEW_AATSR_IMAGE.NADIR_V56 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V56,NEW_AATSR_IMAGE.NADIR_V56)

  NEW_AATSR_IMAGE.FRWRD_V16 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V16,NEW_AATSR_IMAGE.FRWRD_V16)
  NEW_AATSR_IMAGE.FRWRD_V87 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V87,NEW_AATSR_IMAGE.FRWRD_V87)
  NEW_AATSR_IMAGE.FRWRD_V67 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V67,NEW_AATSR_IMAGE.FRWRD_V67)
  NEW_AATSR_IMAGE.FRWRD_V56 = AATSR_REMOVE_DRIFT_CORRECTION(AATSR_IMAGE.VC1_FILE,NEW_AATSR_IMAGE.MPH.SENSING_START,V56,NEW_AATSR_IMAGE.FRWRD_V56)
       
<span class="comments">;Apply new long term drift corrections</span>
  NEW_AATSR_IMAGE.NADIR_V16 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V16,NEW_AATSR_IMAGE.NADIR_V16,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.NADIR_V87 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V87,NEW_AATSR_IMAGE.NADIR_V87,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.NADIR_V67 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V67,NEW_AATSR_IMAGE.NADIR_V67,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.NADIR_V56 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V56,NEW_AATSR_IMAGE.NADIR_V56,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.FRWRD_V16 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V16,NEW_AATSR_IMAGE.FRWRD_V16,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.FRWRD_V87 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V87,NEW_AATSR_IMAGE.FRWRD_V87,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.FRWRD_V67 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V67,NEW_AATSR_IMAGE.FRWRD_V67,DRIFT_TABLE=DRIFT_TABLE)
  NEW_AATSR_IMAGE.FRWRD_V56 = AATSR_APPLY_DRIFT_CORRECTION(NEW_AATSR_IMAGE.MPH.SENSING_START,V56,NEW_AATSR_IMAGE.FRWRD_V56,DRIFT_TABLE=DRIFT_TABLE)   

RETURN,NEW_AATSR_IMAGE

END
</code>
    </div>
  </body>
</html>