<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Thu Jul  4 16:02:15 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>get_vegetation_header_info.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="get_vegetation_header_info.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      GET_VEGETATION_HEADER_INFO       </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      RETIREVES THE HEADER INFORMATION FROM A VEGETATION LOG FILE</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RES = INGEST_VEGETATION_PRODUCT(LOG_FILE)      </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      LOG_FILE   -  THE FULL PATH OF THE LOG FILE TO BE READ     </span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE    - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      VGT_HEADER - A STRUCTURE CONTAINING THE DIMITRI RELEVANT HEADER INFORMATION</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*        17 DEC 2010 - C KENT    - DIMITRI-2 V1.0</span>
<span class="comments">;*        14 JUL 2011 - C KENT    - UPDATED TIME EXTRACTION SECTION</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*        02 DEC 2010 - C KENT    - WINDOWS 32BIT MACHINE idl 7.1: COMPILATION AND EXECUTION </span>
<span class="comments">;*                                  SUCCESSFUL. TESTED MULTIPLE OPTIONS ON MULTIPLE </span>
<span class="comments">;*                                  PRODUCTS</span>
<span class="comments">;*        06 JAN 2011 - C KENT    - LINUX 64-BIT MACHINE IDL 8.0: COMPILATION SUCCESSFUL, </span>
<span class="comments">;*                                  NO APPARENT DIFFERENCES WHEN COMPARED TO WINDOWS MACHINE</span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

FUNCTION GET_VEGETATION_HEADER_INFO,LOG_FILE,VERBOSE=VERBOSE

<span class="comments">;--------------------------------------------</span>
<span class="comments">;CHECK FILE EXISTS</span>

  IF STRCMP(STRING(LOG_FILE),'') THEN BEGIN
    PRINT, 'VEGETATION L1B HEADER: ERROR, NO INPUT FILES PROVIDED, RETURNING...'
    RETURN,{ERROR:-1}
  ENDIF  

  TEMP = FILE_INFO(LOG_FILE)
  IF TEMP.EXISTS EQ 0 THEN BEGIN
    PRINT, 'VEGETATION L1B HEADER: ERROR, LOG FILE DOES NOT EXIST'
    RETURN,{ERROR:-1}
  ENDIF  

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'VEGETATION L1B HEADER: LOG FILE NOMINAL, DEFINING STRUCTURE'

<span class="comments">;--------------------------------------------</span>
<span class="comments">; DEFINE DATA STRUCTURE</span>
  
  TEMP = STRARR(1)
  VGT_HEADER =  {$
                PRD_ID      : TEMP,$
                ACQ_DATE    : TEMP,$
                ACQ_TIME    : TEMP,$
                AUX_GEO     : TEMP,$
                AUX_DEM     : TEMP,$
                AUX_RAD_EQL : TEMP,$
                AUX_RAD_ABS : TEMP $
                }

<span class="comments">;--------------------------------------------</span>
<span class="comments">; READ THE LOG FILE AS A STRING</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'VEGETATION L1B HEADER: READING LOG FILE'
  TEMP = READ_BINARY(LOG_FILE)
  TEMP = STRING(TEMP)

<span class="comments">;--------------------------------------------</span>
<span class="comments">; RETRIEVE DATA</span>
  
  RES = STRPOS(TEMP,'PRODUCT_ID')
    VGT_HEADER.PRD_ID = STRMID(TEMP,RES+26,22)
  RES = STRPOS(TEMP,'SEGM_FIRST_DATE')  
    VGT_HEADER.ACQ_DATE = STRMID(TEMP,RES+26,8)
  RES = STRPOS(TEMP,'SEGM_FIRST_TIME')  
    VGT_HEADER.ACQ_TIME = STRMID(TEMP,RES+26,6)
  RES = STRPOS(TEMP,'GEOM_CHAR_REF')  
   VGT_HEADER.AUX_GEO = STRMID(TEMP,RES+26,26)
  RES = STRPOS(TEMP,'DEM_REF')  
   VGT_HEADER.AUX_DEM = STRMID(TEMP,RES+26,19)
  RES = STRPOS(TEMP,'DEM_DATE')    
   VGT_HEADER.AUX_DEM = STRING(VGT_HEADER.AUX_DEM+'_'+STRMID(TEMP,RES+26,8))    
  RES = STRPOS(TEMP,'RADIOM_EQUAL_REF')  
   VGT_HEADER.AUX_RAD_EQL = STRMID(TEMP,RES+26,26)    
  RES = STRPOS(TEMP,'RADIOM_ABS_CAL_REF')  
   VGT_HEADER.AUX_RAD_ABS = STRMID(TEMP,RES+26,26)

<span class="comments">;--------------------------------------------</span>
<span class="comments">; RETURN THE STRUCTURE</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'VEGETATION L1B HEADER: RETURNING HEADER DATA'
  RETURN,VGT_HEADER

END
</code>
    </div>
  </body>
</html>