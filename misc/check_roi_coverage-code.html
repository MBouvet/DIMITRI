<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Tue Jul  2 12:50:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>check_roi_coverage.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="check_roi_coverage.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      CHECK_ROI_COVERAGE       </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      CHECKS IF THE PROVIDED ROI COORDINATES ARE WITHIN A GIVEN LAT/LON GRID</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RES = CHECK_ROI_COVERAGE(CRC_LAT,CRC_LON,ICOORDS)      </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      CRC_LAT = A GRID OF LATITUDE POINTS IN DEGREES</span>
<span class="comments">;*      CRC_LON = A GRID OF LONGITUDE POINTS IN DEGREES</span>
<span class="comments">;*      ICOORDS = A 4 ELEMENT ARRAY OF THE NLAT, SLAT, ELON, WLON VALUES</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE  - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      ROICOVERED  = -1: ERROR, 0: NOT COMPLETELY COVERED, 1: COVERED</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*      06 MAR 2012 - C KENT   - DIMITRI-2 V1.0</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*      06 MAR 2012 - C KENT   - WINDOWS 32-BIT IDL 7.1 AND LINUX 64-BIT IDL 8.0 NOMINAL</span>
<span class="comments">;*                               COMPILATION AND OPERATION </span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

FUNCTION CHECK_ROI_COVERAGE,CR_LAT,CR_LON,CR_PIX,ICOORDS,VERBOSE=VERBOSE

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'CHECK_ROI_COVERAGE: STARTING COVERAGE CHECK'
  CRCTOL  = 0.5 <span class="comments">; FIND PIXELS WITIN 0.5 DEGREES</span>
  LATID   = [0,0,1,1]
  LONID   = [3,2,2,3]
  PSEL    = [1,-1,-1, 1] <span class="comments">; TL, TR, BR, BL</span>
  
  CORNLATS = ICOORDS[LATID]
  CORNLONS = ICOORDS[LONID]

  LATtDIMS = SIZE(CR_LAT,/DIMENSIONS)
  LONtDIMS = SIZE(CR_LON,/DIMENSIONS)

<span class="comments">;*************************************</span>
<span class="comments">; EXTRACT a square of the valid PIXELS</span>
  
  TEMP = ARRAY_INDICES([LATTDIMS],CR_PIX)<span class="comments">;;!!!!!!!!!#,/DIMENSIONS)</span>
  XMIN = MIN(TEMP[0,*])-2 > 0
  XMAX = MAX(TEMP[0,*])+2 &lt<span class="comments">; (LATTDIMS[0]-1)  </span>
  YMIN = MIN(TEMP[1,*])-2 > 0
  YMAX = MAX(TEMP[1,*])+2 &lt<span class="comments">; (LATTDIMS[1]-1)   </span>
  
  CRC_LAT = CR_LAT[XMIN:XMAX,YMIN:YMAX]
  CRC_LON = CR_LON[XMIN:XMAX,YMIN:YMAX]
  
  LATDIMS = SIZE(CRC_LAT,/DIMENSIONS)
  LONDIMS = SIZE(CRC_LON,/DIMENSIONS)

<span class="comments">;*************************************  </span>
<span class="comments">; CHECK LAT AND LON EQUAL EACH OTHER</span>
  
  IF NOT ARRAY_EQUAL(LATDIMS,LONDIMS) THEN BEGIN
    PRINT, 'CHECK_ROI_COVERAGE: ERROR, LAT AND LON NOT EQUAL SIZES'
    ROICOVERED = -1
    GOTO, NO_CRC
  END

<span class="comments">;*************************************  </span>
<span class="comments">; FOR EACH CORNER PIXEL CHECK IF IT IS COVERED BY LAT LON</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'CHECK_ROI_COVERAGE: STARTING LOOP ON CORNER COORDINATES'
  ROICOVERED = 0
  FOR CRCI = 0,N_ELEMENTS(ICOORDS)-1 DO BEGIN
  
   <span class="comments">; LOC = WHERE(ABS(CRC_LAT-CORNLATS[CRCI]) LT CRCTOL AND ABS(CRC_LON-CORNLONS[CRCI]) LT CRCTOL,CRCCOUNT)</span>
    
   <span class="comments">; IF CRCCOUNT EQ 0 THEN BEGIN</span>
   <span class="comments">;   ROICOVERED = 0</span>
   <span class="comments">;   GOTO, NO_CRC</span>
   <span class="comments">; ENDIF</span>
    
   <span class="comments">; PDIST = GREAT_CIRCLE_DISTANCE(CORNLATS[CRCI],CORNLONS[CRCI],CRC_LAT[LOC],CRC_LON[LOC],/DEGREES)</span>
    PDIST = GREAT_CIRCLE_DISTANCE(CORNLATS[CRCI],CORNLONS[CRCI],CRC_LAT,CRC_LON,/DEGREES)
    A   = MIN(PDIST)
    SS  = WHERE(ABS(PDIST-A) LT 0.000001)
    
    <span class="comments">;CRCINDXS = ARRAY_INDICES(LATDIMS,LOC[SS[0]]);;!!!!!!!1,/DIMENSIONS)</span>
    CRCINDXS = ARRAY_INDICES(LATDIMS,SS[0])<span class="comments">;;!!!!!!!!!!,/DIMENSIONS)</span>
    NX = CRCINDXS[0]
    NY = CRCINDXS[1]
    NNX = NX+PSEL[CRCI] > 0 &lt<span class="comments">; (LATDIMS[0]-1)</span>
  
    PDIST = GREAT_CIRCLE_DISTANCE(CRC_LAT[NX,NY],CRC_LON[NX,NY],CRC_LAT[NNX,NY],CRC_LON[NNX,NY],/DEGREES)
    
    IF A LT PDIST*1.125 THEN ROICOVERED = 1 ELSE BEGIN
     
      ROICOVERED = 0
      GOTO, NO_CRC
    ENDELSE
  
  ENDFOR

<span class="comments">;************************************* </span>
<span class="comments">; RETURN COVERAGE VALUE</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT,'CHECK_ROI_COVERAGE: COMPLETED ROI COVERAGE CHECK'  
  NO_CRC:
  
  RETURN,ROICOVERED

END
</code>
    </div>
  </body>
</html>