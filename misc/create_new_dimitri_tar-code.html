<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Tue Jul  2 12:50:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>create_new_dimitri_tar.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="create_new_dimitri_tar.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      CREATE_NEW_DIMITRI_TAR            </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      CREATES A NEW DIMITRI TAR DISTRIBUTION - ONLY FOR USE ON KEPLER</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      CREATE_NEW_DIMITRI_TAR      </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      </span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE   - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      </span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*      13 JUN 2012 - C KENT   - DIMITRI-2 V1.0</span>
<span class="comments">;*      03 Aug 2012 - K Barker   UPDATE: User Manual added to .tar</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

PRO CREATE_NEW_DIMITRI_TAR

<span class="comments">; DEFINE INPUT AND OUTPUT FOLDER LOCATIONS</span>
  
  IFOLDER = '/mnt/Projects/MEREMSII/DIMITRI/20120305/'
  OFOLDER = '/mnt/Projects/MEREMSII/DIMITRI/new_dist/'<span class="comments">; update this location to where you want the new distribution to be </span>
  DIMITRI = 'DIMITRI_2.0'
  DL = PATH_SEP()
  STIME = SYSTIME()

<span class="comments">; CREATE NEW DIMITRI FOLDER</span>

  IF ~FILE_TEST(OFOLDER)         THEN FILE_MKDIR,OFOLDER
  IF ~FILE_TEST(OFOLDER+DIMITRI) THEN FILE_MKDIR,OFOLDER+DIMITRI

<span class="comments">; COPY BIN, AUX DATA, OUTPUT FOLDERS, DIMITRI SAV + User Manual</span>

  SPAWN, 'cp -rf '+IFOLDER+DIMITRI+DL+'User_Manual.pdf '+OFOLDER+DIMITRI+DL
  SPAWN, 'cp -rf '+IFOLDER+DIMITRI+DL+'AUX_DATA '+OFOLDER+DIMITRI+DL
  SPAWN, 'cp -rf '+IFOLDER+DIMITRI+DL+'Bin '+OFOLDER+DIMITRI+DL
  SPAWN, 'cp -rf '+IFOLDER+DIMITRI+DL+'DIMITRI_V2.sav '+OFOLDER+DIMITRI+DL
  IF ~FILE_TEST(OFOLDER+DIMITRI+DL+'Output') THEN FILE_MKDIR,OFOLDER+DIMITRI+DL+'Output'  
  IF ~FILE_TEST(OFOLDER+DIMITRI+DL+'Input')  THEN FILE_MKDIR,OFOLDER+DIMITRI+DL+'Input' 
  SPAWN, 'cp -rf '+IFOLDER+DIMITRI+DL+'Source '+OFOLDER+DIMITRI+DL
  FILE_DELETE,OFOLDER+DIMITRI+DL+'Source'+DL+'.git',/RECURSIVE
  FILE_DELETE,OFOLDER+DIMITRI+DL+'Source'+DL+'validation',/RECURSIVE  

  SITES     = ['Amazon','BOUSSOLE','DomeC','Libya4','SIO','SPG','TuzGolu','Uyuni']
  SENSORS   = ['AATSR','ATSR2','MERIS','MERIS','MODISA','PARASOL','VEGETATION']
  PROC_VERS = ['2nd_Reprocessing','Reprocessing_2008','2nd_Reprocessing','3rd_Reprocessing','Collection_5','Calibration_1','Calibration_1']
  YEARS     = ['2002','2003','2004','2005','2006','2007','2008','2009','2010','2011','2012']

  FOR I=0L,N_ELEMENTS(SITES)-1 DO BEGIN
   
    INF = IFOLDER+DIMITRI+DL+'Input'+DL
    ONF = OFOLDER+DIMITRI+DL+'Input'+DL
    SF = ONF+'Site_'+SITES[I]
    FILE_MKDIR,SF
    
    FOR J=0L,N_ELEMENTS(SENSORS)-1 DO BEGIN
 
      TF = SF+DL+SENSORS[J]
      FILE_MKDIR,TF
      PF = TF+DL+'Proc_'+PROC_VERS[J]
      FILE_MKDIR,PF
      OPF = INF+'Site_'+SITES[I]+DL+SENSORS[J]+DL+'Proc_'+PROC_VERS[J]
      RES = FILE_SEARCH(OPF,STRING('*'+SENSORS[J]+'_*'))
      IF RES[0] NE '' THEN FOR M=0L,N_ELEMENTS(RES)-1 DO FILE_COPY,RES[M],PF,/OVERWRITE
       
      FOR K = 0L,N_ELEMENTS(YEARS)-1 DO BEGIN
 
        YF = PF+DL+YEARS[K]
        FILE_MKDIR,YF
        OYF = OPF+DL+YEARS[K]
        IF SENSORS[J] NE 'VEGETATION' THEN BEGIN
          
          RES = FILE_SEARCH(OYF,'*.jpg')
          IF RES[0] NE '' THEN FOR M=0L,N_ELEMENTS(RES)-1 DO FILE_COPY,RES[M],YF 
        
        ENDIF ELSE BEGIN
          
          IF FILE_TEST(OYF) EQ 1 THEN BEGIN
          
            RES = FILE_SEARCH(OYF,'*.jpg')
            IF RES[0] NE '' THEN BEGIN
              
              FOR M=0,N_ELEMENTS(RES)-1 DO BEGIN
                
                OFOLD = YF+STRMID(RES[M],STRLEN(YF),STRLEN(RES[M])-STRLEN(YF))
                FILE_MKDIR,STRMID(OFOLD,0,STRLEN(OFOLD)-18)
                FILE_COPY,RES[M],OFOLD 
                
              ENDFOR
              
            ENDIF
          ENDIF
        ENDELSE
      ENDFOR
    ENDFOR
  ENDFOR

<span class="comments">; TAR IT INTO A DISTRIBUTABLE PACKAGE</span>
  
  CD,CURRENT=CDIR
  CD,OFOLDER
  SPAWN,'tar -zcvf DIMITRI_V2.tar.gz '+DIMITRI+DL
  CD,CDIR

  PRINT
  PRINT,'**********************************'
  PRINT,'*   COMPLETED DIMITRI TAR        *
  PRINT,'*   S: '+STIME+'  *
  PRINT,'*   E: '+SYSTIME()+'  *
  PRINT,'**********************************'
    
END
</code>
    </div>
  </body>
</html>